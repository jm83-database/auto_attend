# MS 출결확인 자동화 프로그램

이 프로그램은 MS Teams 출석 정보와 참석 보고서를 기반으로 MS 출결확인 양식 Excel 파일을 자동으로 업데이트하는 Flask 웹 애플리케이션입니다.

## 주요 기능

1. 출석 정보(attendance_20250411_1118.csv)에서 학생들의 출석 여부를 확인하여 "중간출결" 열에 "O" 표시
2. 참석보고서(파이썬 기본 및 데이터분석2 참석 보고서 41125.csv)에서 학생들의 참여 정보를 추출하여 다음 항목 업데이트:
   - "들어온 시간" → "접속시작시간" 열에 업데이트
   - "마지막 나간 시간" → "접속종료시간" 열에 업데이트
   - "모임 참여 시간" → "활용시간" 열에 업데이트
3. 업데이트된 Excel 파일을 즉시 다운로드 가능
4. 보안 및 디스크 공간 관리를 위해 다운로드 후 1분 뒤 자동 파일 삭제

## 시스템 요구사항

- Python 3.6 이상
- Flask
- pandas
- openpyxl
- threading (표준 라이브러리)

## 설치 방법

1. 필요한 Python 라이브러리 설치:

```bash
pip install flask pandas openpyxl
```

또는 다음 명령어로 일괄 설치:

```bash
pip install -r requirements.txt
```

## 사용 방법

1. 다음 명령어로 서버 실행:

```bash
python app.py
```

2. 웹 브라우저에서 http://localhost:5000/ 접속
3. 파일 업로드 폼에서 다음 파일들을 선택:
   - MS 출결확인 양식.xlsx
   - attendance_20250411_1118.csv (출석 정보)
   - 파이썬 기본 및 데이터분석2 참석 보고서 41125.csv
4. "업데이트 실행" 버튼 클릭
5. 업데이트 결과가 표시되며, "업데이트된 Excel 파일 다운로드" 버튼을 클릭하여 파일을 즉시 다운로드할 수 있습니다.
6. 다운로드 후 1분 뒤에 서버에서 파일이 자동으로 삭제됩니다.

## 파일 구조

- app.py: Flask 애플리케이션 메인 파일
- templates/: HTML 템플릿 파일
  - index.html: 메인 페이지 템플릿
- uploads/: 업로드된 파일 임시 저장 폴더
- results/: 업데이트된 결과 파일 저장 폴더 (파일은 다운로드 후 1분 뒤 자동 삭제)
- static/: 정적 파일 저장 폴더
  - results/: 웹에서 접근 가능한 결과 파일 저장 폴더

## 주의사항

1. 참석보고서 CSV 파일은 UTF-16LE 인코딩으로 되어 있어야 합니다.
2. MS 출결확인 양식 Excel 파일에는 "출결정보" 시트가 있어야 하고 다음 열이 포함되어야 합니다:
   - "성명" (D열)
   - "중간출결" (K열)
   - "접속시작시간" (H열)
   - "접속종료시간" (I열) 
   - "활용시간" (J열)
3. 출석 정보 CSV 파일에는 "이름"과 "출석여부" 열이 포함되어야 합니다.
4. 업데이트된 셀은 주황색(#FFB366)으로 표시됩니다.
5. 생성된 파일은 다운로드 후 1분 뒤에 자동으로 삭제되므로 필요한 경우 다운로드 파일을 반드시 저장해 두세요.

## 문제 해결

- 파일 업로드 오류 발생 시 인코딩 문제일 수 있습니다. 참석보고서 CSV 파일이 UTF-16LE 인코딩인지 확인하세요.
- 열 구조가 맞지 않을 경우 app.py 파일에서 해당 열 인덱스를 수정해야 할 수 있습니다.
- 다운로드 링크가 작동하지 않는 경우 results 폴더에 쓰기 권한이 있는지 확인하세요.
